<div class="patient-list-container">
  <div class="header-section">
    <h1>Patient Management</h1>
    
    <div class="search-section">
      <mat-form-field appearance="outline" class="search-field">
        <mat-label>Search patients</mat-label>
        <input matInput 
               [(ngModel)]="searchTerm" 
               (input)="onSearchChange()"
               placeholder="Search by name, email, or phone">
        <button mat-icon-button matSuffix (click)="clearSearch()" *ngIf="searchTerm">
          <mat-icon>clear</mat-icon>
        </button>
      </mat-form-field>
      
      <button mat-raised-button 
              color="primary" 
              [routerLink]="['/patients/create']"
              class="add-patient-btn">
        <mat-icon>person_add</mat-icon>
        <span>Add New Patient</span>
      </button>

      <button mat-raised-button 
              color="accent" 
              [routerLink]="['/activity-log']"
              class="activity-log-btn">
        <mat-icon>history</mat-icon>
        <span>Activity Log</span>
      </button>
    </div>
  </div>

  <div class="table-container">
    <table mat-table [dataSource]="patients" class="patients-table">
      <ng-container matColumnDef="name">
        <th mat-header-cell *matHeaderCellDef>Name</th>
        <td mat-cell *matCellDef="let patient">{{getFullName(patient)}}</td>
      </ng-container>

      <ng-container matColumnDef="dateOfBirth">
        <th mat-header-cell *matHeaderCellDef>Date of Birth</th>
        <td mat-cell *matCellDef="let patient">{{formatDate(patient.dateOfBirth)}}</td>
      </ng-container>

      <ng-container matColumnDef="gender">
        <th mat-header-cell *matHeaderCellDef>Gender</th>
        <td mat-cell *matCellDef="let patient">{{patient.gender}}</td>
      </ng-container>

      <ng-container matColumnDef="phone">
        <th mat-header-cell *matHeaderCellDef>Phone</th>
        <td mat-cell *matCellDef="let patient">{{patient.phone}}</td>
      </ng-container>

      <ng-container matColumnDef="email">
        <th mat-header-cell *matHeaderCellDef>Email</th>
        <td mat-cell *matCellDef="let patient">{{patient.email}}</td>
      </ng-container>

      <ng-container matColumnDef="actions">
        <th mat-header-cell *matHeaderCellDef>Actions</th>
        <td mat-cell *matCellDef="let patient" class="action-cell">
          <button mat-icon-button 
                  [routerLink]="['/patients/view', patient.patientID || patient.id]"
                  matTooltip="View Details"
                  class="action-btn view-btn">
            <mat-icon>visibility</mat-icon>
          </button>
          
          <button mat-icon-button 
                  [routerLink]="['/patients/edit', patient.patientID || patient.id]"
                  matTooltip="Edit Patient"
                  class="action-btn edit-btn">
            <mat-icon>edit</mat-icon>
          </button>
          
          <button mat-icon-button 
                  (click)="deletePatient(patient)"
                  matTooltip="Delete Patient"
                  class="action-btn delete-btn">
            <mat-icon>delete</mat-icon>
          </button>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
    </table>

    <div class="no-data" *ngIf="patients.length === 0">
      <mat-icon>group</mat-icon>
      <p>No patients found</p>
      <button mat-raised-button 
              color="primary" 
              *ngIf="canCreatePatients()"
              [routerLink]="['/patients/create']">
        Add First Patient
      </button>
    </div>
  </div>
</div>
